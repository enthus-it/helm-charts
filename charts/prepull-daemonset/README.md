# prepull-daemonset

![Version: 0.0.1](https://img.shields.io/badge/Version-0.0.1-informational?style=flat-square) ![Type: application](https://img.shields.io/badge/Type-application-informational?style=flat-square)

A daemonset to prepull images so they are cached on every node

Based on [rstudio/prepull-daemonset](https://github.com/rstudio/helm/tree/main/other-charts/prepull-daemonset).

## Installing the Chart

To install the chart with the release name `prepull-daemonset` at version 0.0.1:

```console
helm repo add enthus-it https://enthus-it.github.io/helm-charts
helm repo update
helm show values enthus-it/prepull-daemonset
helm install prepull-daemonset enthus-it/prepull-daemonset
```

## Usage

List your images required to be pre-pulled at `values.yaml` file with the format,

```yaml
images:
  - name: my-first-image
    image: some-id.dkr.ecr.us-east-1.amazonaws.com/my-ecr-repo:latest
  - name: my-second-image
    image: some-id.dkr.ecr.us-east-1.amazonaws.com/my-other-repo:latest
  - name: my-third-public-image
    image: ubuntu:bionic
```

## Pull Again

To run the pre-pull again (i.e. to pull new images with the same tag, to ensure node
caches :one: are fresh), there are a few options:

```console
# by default, every upgrade is randomized / does a rollout (`--set randomize=false` to disable this behavior)
helm upgrade install prepull-daemonset enthus-it/prepull-daemonset

# or use kubectl
kubectl rollout restart daemonset/prepull-daemonset
```

> :one: Kubernetes Nodes (specifically, the `kubelet` service) periodically remove images from
> the node's cache to free up disk space, especially if an image is not in use and has
> not been used lately

## Values

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| images[0].image | string | `"ubuntu:jammy"` |  |
| images[0].name | string | `"ubuntu-jammy"` |  |
| pauseImage | string | `"registry.k8s.io/pause:3.6"` |  |
| randomize | bool | `true` |  |
| updateStrategy | object | `{}` |  |

----------------------------------------------
Autogenerated from chart metadata using [helm-docs v1.13.1](https://github.com/norwoodj/helm-docs/releases/v1.13.1)
